# ç¬¬ä¸€èŠ‚ ç¯å¢ƒé…ç½®ä¸é¡¹ç›®æ¶æ„

> ç»è¿‡å‰é¢åå‡ å¤©çš„é–æˆ˜ä¹Ÿæ˜¯ç»ˆäºæ¥åˆ°äº†é¡¹ç›®å®æˆ˜ç¯èŠ‚ã€‚æ¥ä¸‹æ¥ï¼Œé€šè¿‡ä¸€ä¸ªå®Œæ•´çš„å®æˆ˜é¡¹ç›®æ¥æŠŠå‰é¢å­¦åˆ°çš„çŸ¥è¯†ä¸²è”èµ·æ¥ï¼Œæ„å»ºä¸€ä¸ªçœŸæ­£å¯ç”¨çš„RAGç³»ç»Ÿã€‚

## ä¸€ã€é¡¹ç›®èƒŒæ™¯

è¿™ä¸ªé¡¹ç›®çš„çµæ„Ÿæ¥è‡ªäºç¬”è€…å‰æ®µæ—¶é—´åˆ·è§†é¢‘æ—¶ï¼Œå¶ç„¶çœ‹åˆ°äº†ä¸€ä¸ªæœ‰è¶£çš„å¼€æºé¡¹ç›®ä»‹ç»â€”â€”[ç¨‹åºå‘˜åšé¥­æŒ‡å—](https://github.com/Anduin2017/HowToCook)ã€‚è¿™æ˜¯ä¸€ä¸ªèœè°±é¡¹ç›®ï¼Œç”¨Markdownæ ¼å¼è®°å½•äº†å„ç§èœå“çš„åˆ¶ä½œæ–¹æ³•ï¼Œä»ç®€å•çš„å®¶å¸¸èœåˆ°å¤æ‚çš„å®´å®¢èœï¼Œåº”æœ‰å°½æœ‰ã€‚æ›´å®Œç¾çš„æ˜¯ï¼Œè¿™ä¸ªé¡¹ç›®ä¸­æ¯é“èœçš„Markdownæ–‡ä»¶éƒ½ä¸¥æ ¼ä½¿ç”¨ç»Ÿä¸€çš„å°æ ‡é¢˜ã€‚

çœ‹åˆ°è¿™ä¸ªé¡¹ç›®ï¼Œç¬”è€…ç«‹åˆ»æƒ³åˆ°ï¼šèƒ½ä¸èƒ½æ„å»ºä¸€ä¸ªæ™ºèƒ½é—®ç­”ç³»ç»Ÿæ¥è§£å†³æˆ‘çš„é€‰æ‹©å›°éš¾ç—‡ï¼Ÿæ¯å¤©é¢å¯¹"ä»Šå¤©åƒä»€ä¹ˆ"è¿™ä¸ªä¸–çºªéš¾é¢˜ï¼Œå¦‚æœæœ‰ä¸ªAIåŠ©æ‰‹èƒ½æ ¹æ®æˆ‘çš„éœ€æ±‚æ¨èèœå“ã€å‘Šè¯‰æˆ‘æ€ä¹ˆåšï¼Œé‚£è¯¥å¤šå¥½ï¼äºæ˜¯å°±æœ‰äº†æ­å»ºè¿™ä¸ª**å°å°å’¸æ·¡RAGç³»ç»Ÿ**çš„æƒ³æ³•ã€‚

## äºŒã€ç¯å¢ƒé…ç½®

### 2.1 åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ

```bash
# ä½¿ç”¨condaåˆ›å»ºç¯å¢ƒ
conda create -n cook-rag-1 python=3.12.7
conda activate cook-rag-1
```

### 2.2 å®‰è£…æ ¸å¿ƒä¾èµ–

è€è§„çŸ©ï¼Œè¿›å…¥æœ¬ç« å¯¹åº”é¡¹ç›®ç›®å½•å®‰è£…ä¾èµ–åŒ…

```bash
cd code/C8
pip install -r requirements.txt
```

å¦‚æœ API Key å·²ç»é…ç½®å¥½äº†ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨ä¸‹é¢å‘½ä»¤è¿è¡Œé¡¹ç›®

```bash
python main.py
```

### 2.3 ç”³è¯·Kimi API Key

Kimi2 å‘å¸ƒç¬¬å…«å¤©æ¥å°å°å’¸æ·¡ï¼Œç”³è¯·åœ°å€ï¼š[Kimi APIå®˜ç½‘](https://platform.moonshot.cn/console/api-keys)ã€‚ç›®å‰æ³¨å†Œä¼šé€15å…ƒçš„é¢åº¦ï¼Œç»°ç»°æœ‰ä½™äº†ã€‚

### 2.4 APIé…ç½®

å‚è€ƒå‰é¢ç« èŠ‚ [**ç¯å¢ƒå‡†å¤‡**](../chapter1/02_preparation.md) ä¸­å…³äºapi_keyçš„é…ç½®æ–¹æ³•ã€‚åœ¨windowsä¸‹ï¼Œé…ç½®å®Œæˆååº”è¯¥å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š

![APIé…ç½®](./images/8_1_1.webp)

## ä¸‰ã€é¡¹ç›®æ¶æ„

### 3.1 é¡¹ç›®ç›®æ ‡

æˆ‘ä»¬å°†åŸºäºHowToCooké¡¹ç›®çš„èœè°±æ•°æ®ï¼Œæ„å»ºä¸€ä¸ªæ™ºèƒ½çš„é£Ÿè°±é—®ç­”ç³»ç»Ÿã€‚ç”¨æˆ·å¯ä»¥ï¼š

- è¯¢é—®å…·ä½“èœå“çš„åˆ¶ä½œæ–¹æ³•ï¼š"å®«ä¿é¸¡ä¸æ€ä¹ˆåšï¼Ÿ"
- å¯»æ±‚èœå“æ¨èï¼š"æ¨èå‡ ä¸ªç®€å•çš„ç´ èœ"
- è·å–é£Ÿæä¿¡æ¯ï¼š"çº¢çƒ§è‚‰éœ€è¦ä»€ä¹ˆé£Ÿæï¼Ÿ"

### 3.2 æ•°æ®åˆ†æ

#### 3.2.1 æ–‡æ¡£åˆ†æ

HowToCooké¡¹ç›®åŒ…å«äº†å¤§çº¦300å¤šä¸ªMarkdownæ ¼å¼çš„èœè°±æ–‡ä»¶ã€‚è¿™äº›èœè°±æœ‰ä¸¤ä¸ªå…³é”®ç‰¹ç‚¹ï¼šä¸€æ˜¯ç»“æ„é«˜åº¦è§„æ•´ï¼Œæ¯ä¸ªæ–‡ä»¶éƒ½ä¸¥æ ¼æŒ‰ç…§ç»Ÿä¸€çš„æ ¼å¼æ¥ç»„ç»‡å†…å®¹ï¼›äºŒæ˜¯å†…å®¹ç¯‡å¹…è¾ƒçŸ­ï¼Œå•ä¸ªèœè°±é€šå¸¸åœ¨700å­—å·¦å³ã€‚

æ‰“å¼€ä»»æ„ä¸€ä¸ªèœè°±æ–‡ä»¶ï¼Œå¯ä»¥å‘ç°å®ƒä»¬éƒ½éµå¾ªç€ç›¸ä¼¼çš„ç»“æ„æ¨¡å¼ã€‚é€šå¸¸ä»¥èœå“åšæ³•ä½œä¸ºä¸€çº§æ ‡é¢˜ï¼Œå¼€å¤´ä¼šæœ‰ä¸€æ®µç®€ä»‹å’Œéš¾åº¦è¯„çº§ï¼Œç„¶ååˆ†ä¸º"å¿…å¤‡åŸæ–™å’Œå·¥å…·"ã€"è®¡ç®—"ã€"æ“ä½œ"ã€"é™„åŠ å†…å®¹"ç­‰å‡ ä¸ªä¸»è¦éƒ¨åˆ†ã€‚æ¯”å¦‚è¥¿çº¢æŸ¿ç‚’é¸¡è›‹è¿™é“èœï¼š

```markdown
# è¥¿çº¢æŸ¿ç‚’é¸¡è›‹çš„åšæ³•

è¥¿çº¢æŸ¿ç‚’è›‹æ˜¯ä¸­å›½å®¶å¸¸å‡ ä¹æœ€å¸¸è§çš„ä¸€é“èœè‚´...
é¢„ä¼°çƒ¹é¥ªéš¾åº¦ï¼šâ˜…â˜…

## å¿…å¤‡åŸæ–™å’Œå·¥å…·
* è¥¿çº¢æŸ¿
* é¸¡è›‹
* é£Ÿç”¨æ²¹...

## è®¡ç®—
æ¯æ¬¡åˆ¶ä½œå‰éœ€è¦ç¡®å®šè®¡åˆ’åšå‡ ä»½...
* è¥¿çº¢æŸ¿ = 1 ä¸ªï¼ˆçº¦ 180gï¼‰ * ä»½æ•°
* é¸¡è›‹ = 1.5 ä¸ª * ä»½æ•°ï¼Œå‘ä¸Šå–æ•´...

## æ“ä½œ
- è¥¿çº¢æŸ¿æ´—å‡€
- å¯é€‰ï¼šå»æ‰è¥¿çº¢æŸ¿çš„å¤–è¡¨çš®...

## é™„åŠ å†…å®¹
è¿™é“èœæ ¹æ®ä¸åŒçš„å£å‘³åå¥½ï¼Œå­˜åœ¨è¯¸å¤šç‰ˆæœ¬...
```

ä»æ•°æ®ä¸Šæ¥çœ‹ï¼Œè¿™ç§é«˜åº¦ç»“æ„åŒ–çš„æ•°æ®ä¸éœ€è¦è¿‡å¤šå¤„ç†å°±å¯ä»¥ç›´æ¥ç”¨äºRAGç³»ç»Ÿæ„å»ºã€‚è¿˜è®°å¾—æˆ‘ä»¬åœ¨ç¬¬2ç« å­¦è¿‡çš„[**Markdownç»“æ„åˆ†å—**](../chapter2/05_text_chunking.md#34-åŸºäºæ–‡æ¡£ç»“æ„çš„åˆ†å—)å—ï¼Ÿè¿™ä¸ªæ•°æ®å®Œå…¨å¥‘åˆé‚£ç§æŒ‰æ ‡é¢˜å±‚çº§åˆ†å—çš„æ€è·¯ã€‚æ›´é‡è¦çš„æ˜¯ï¼Œæ¯ä¸ªèœè°±æ–‡ä»¶çš„å†…å®¹éƒ½ä¸ç®—å¤ªé•¿ï¼Œå•ä¸ªç« èŠ‚çš„å†…å®¹é€šå¸¸åœ¨å‡ ç™¾å­—å·¦å³ï¼Œè¿™æ„å‘³ç€å¯ä»¥ç›´æ¥æŒ‰ç…§æ ‡é¢˜è¿›è¡Œåˆ†å—ï¼Œè€Œä¸ç”¨æ‹…å¿ƒç¬¬2ç« æåˆ°çš„é‚£ä¸ªé—®é¢˜â€”â€”æŸä¸ªç« èŠ‚å†…å®¹è¿‡é•¿è¶…å‡ºæ¨¡å‹ä¸Šä¸‹æ–‡çª—å£ï¼Œéœ€è¦ä¸å¸¸è§„åˆ†å—æ–¹æ³•ï¼ˆå¦‚`RecursiveCharacterTextSplitter`ï¼‰ç»„åˆä½¿ç”¨ã€‚

#### 3.2.2 ç»“æ„åˆ†å—å±€é™

è™½ç„¶Markdownç»“æ„åˆ†å—çœ‹èµ·æ¥å¾ˆç†æƒ³ï¼Œä½†åœ¨å®é™…ä½¿ç”¨ä¸­å¯èƒ½ä¼šé‡åˆ°ä¸€ä¸ªé—®é¢˜ï¼šæŒ‰ç…§æ ‡é¢˜ä¸¥æ ¼åˆ†å—ä¼šæŠŠå†…å®¹åˆ‡å¾—å¤ªç»†ï¼Œå¯¼è‡´ä¸Šä¸‹æ–‡ä¿¡æ¯ä¸å®Œæ•´ã€‚æ¯”å¦‚ç”¨æˆ·é—®"å®«ä¿é¸¡ä¸æ€ä¹ˆåš"ï¼Œå¦‚æœä¸¥æ ¼æŒ‰æ ‡é¢˜åˆ†å—ï¼Œå¯èƒ½åªæ£€ç´¢åˆ°"æ“ä½œ"è¿™ä¸€ä¸ªç« èŠ‚ï¼Œä½†ç¼ºå°‘äº†"å¿…å¤‡åŸæ–™å’Œå·¥å…·"çš„ä¿¡æ¯ï¼ŒLLMå°±æ— æ³•ç»™å‡ºå®Œæ•´çš„åˆ¶ä½œæŒ‡å¯¼ã€‚ç”šè‡³æœ‰æ—¶å€™æ£€ç´¢åˆ°çš„æ˜¯"é™„åŠ å†…å®¹"ä¸­çš„æŸä¸ªå˜åŒ–åšæ³•ï¼Œæ²¡æœ‰åŸºç¡€åˆ¶ä½œæ­¥éª¤ï¼Œå›ç­”å°±ä¼šæ˜¾å¾—è«åå…¶å¦™ã€‚å¦‚æœä½ å°è¯•ç›´æ¥æŠŠæ•´ä¸ªèœè°±æ–‡æ¡£ä½œä¸ºä¸€ä¸ªå—ï¼Œå¯ä»¥å‘ç°æ•ˆæœåè€Œæ¯”ç»“æ„åˆ†å—è¦å¥½ï¼Œå› ä¸ºä¸Šä¸‹æ–‡ä¿¡æ¯æ˜¯å®Œæ•´çš„ã€‚

ä¸ºäº†è§£å†³è¿™ä¸ªçŸ›ç›¾ï¼Œå¯ä»¥é‡‡ç”¨çˆ¶å­æ–‡æœ¬å—çš„ç­–ç•¥ï¼šç”¨å°çš„å­å—è¿›è¡Œç²¾ç¡®æ£€ç´¢ï¼Œä½†åœ¨ç”Ÿæˆæ—¶ä¼ é€’å®Œæ•´çš„çˆ¶æ–‡æ¡£ç»™LLMã€‚è¿™ç§æ–¹æ³•åœ¨ç¬¬3ç« çš„ç´¢å¼•ä¼˜åŒ–ä¸­è™½ç„¶æ²¡æœ‰ä¸“é—¨ä»‹ç»ï¼Œä½†æœ¬è´¨ä¸Šä¹Ÿå±äºä¸Šä¸‹æ–‡æ‹“å±•çš„ä¸€ç§åº”ç”¨ã€‚é€šè¿‡è¿™ç§æ–¹å¼ï¼Œæˆ‘ä»¬æ—¢ä¿è¯äº†æ£€ç´¢çš„ç²¾ç¡®æ€§ï¼Œåˆç¡®ä¿äº†ç”Ÿæˆæ—¶ä¸Šä¸‹æ–‡çš„å®Œæ•´æ€§ã€‚

> åæ­£éƒ½æ˜¯æŠŠæ•´ä¸ªæ–‡æ¡£ä¼ ç»™LLMï¼Œæˆ‘ä¸ºä»€ä¹ˆä¸ç›´æ¥ç”¨æ•´ä¸ªæ–‡æ¡£åˆ†å—å‘¢ï¼Ÿ

è¿™ä¸ªé—®é¢˜é—®å¾—å¾ˆå¥½ï¼å…³é”®åœ¨äºå½“ç”¨æˆ·é—®"å®«ä¿é¸¡ä¸éœ€è¦ä»€ä¹ˆè°ƒæ–™"æ—¶ï¼Œå¦‚æœç›´æ¥ç”¨æ•´ä¸ªæ–‡æ¡£åšå‘é‡æ£€ç´¢ï¼Œè¿™ä¸ªå…·ä½“é—®é¢˜åœ¨æ•´ä¸ªæ–‡æ¡£ä¸­çš„å æ¯”å¾ˆå°ï¼Œå¾ˆå¯èƒ½æ£€ç´¢ä¸åˆ°æˆ–è€…æ’åå¾ˆé åã€‚ä½†å¦‚æœç”¨å°å—æ£€ç´¢ï¼Œ"å¿…å¤‡åŸæ–™å’Œå·¥å…·"è¿™ä¸ªç« èŠ‚å°±èƒ½ç²¾ç¡®åŒ¹é…ç”¨æˆ·çš„éœ€æ±‚ã€‚

ç®€å•æ¥è¯´ï¼Œè¿™ç§è®¾è®¡æ˜¯"å°å—æ£€ç´¢ï¼Œå¤§å—ç”Ÿæˆ"â€”â€”ç”¨å°å—çš„ç²¾ç¡®æ€§æ‰¾åˆ°ç›¸å…³å†…å®¹ï¼Œç”¨å¤§å—çš„å®Œæ•´æ€§ä¿è¯å›ç­”è´¨é‡ã€‚å¦‚æœç›´æ¥ç”¨æ•´ä¸ªæ–‡æ¡£åˆ†å—ï¼Œå°±å¤±å»äº†æ£€ç´¢çš„ç²¾ç¡®æ€§ä¼˜åŠ¿ã€‚

### 3.3 æ•´ä½“æ¶æ„

æ•°æ®å¤„ç†å¥½ä¹‹åï¼Œå‰©ä½™çš„éƒ¨åˆ†å°±æ˜¯å››ä¸ªä¸»è¦æµç¨‹çš„ç»„åˆï¼Œæ¯ä¸ªæµç¨‹å¯¹å·¥å…·è¿›è¡Œç­›é€‰å’Œä¼˜åŒ–åå°±å¯ä»¥æ„å»ºå‡ºä¸€ä¸ªç®€å•çš„ragç³»ç»Ÿã€‚å½“å‰é¡¹ç›®çš„æ¶æ„å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š

```mermaid
flowchart TD
    %% ç³»ç»Ÿåˆå§‹åŒ–
    START[ğŸš€ ç³»ç»Ÿå¯åŠ¨] --> CONFIG[âš™ï¸ åŠ è½½é…ç½®<br/>RAGConfig]
    CONFIG --> INIT[ğŸ”§ åˆå§‹åŒ–æ¨¡å—]
    
    %% ç´¢å¼•åŠ è½½/æ„å»º
    INIT --> INDEX_CHECK{ğŸ“‚ æ£€æŸ¥ç´¢å¼•ç¼“å­˜}
    INDEX_CHECK -->|å­˜åœ¨| LOAD_INDEX[âš¡ åŠ è½½å·²ä¿å­˜ç´¢å¼•<br/>ç§’çº§å¯åŠ¨]
    INDEX_CHECK -->|ä¸å­˜åœ¨| BUILD_NEW[ğŸ”¨ æ„å»ºæ–°ç´¢å¼•]
    
    %% æ„å»ºæ–°ç´¢å¼•çš„é¡ºåºæµç¨‹
    BUILD_NEW --> DataPrep
    DataPrep --> IndexBuild
    IndexBuild --> SAVE_INDEX[ğŸ’¾ ä¿å­˜ç´¢å¼•åˆ°é…ç½®è·¯å¾„]
    
    %% åŠ è½½å·²æœ‰ç´¢å¼•ä¹Ÿéœ€è¦æ•°æ®å‡†å¤‡ï¼ˆç”¨äºæ£€ç´¢æ¨¡å—ï¼‰
    LOAD_INDEX --> DataPrepForRetrieval[ğŸ“š åŠ è½½æ–‡æ¡£å’Œåˆ†å—<br/>ç”¨äºæ£€ç´¢æ¨¡å—]
    DataPrepForRetrieval --> READY[âœ… ç³»ç»Ÿå°±ç»ª]
    SAVE_INDEX --> READY
    
    %% ç”¨æˆ·äº¤äº’å¼€å§‹
    READY --> A[ğŸ‘¤ ç”¨æˆ·è¾“å…¥é—®é¢˜]
    A --> B{ğŸ¯ æŸ¥è¯¢è·¯ç”±}
    
    %% æŸ¥è¯¢è·¯ç”±åˆ†æ”¯
    B -->|list| C[ğŸ“‹ æ¨èæŸ¥è¯¢]
    B -->|detail| D[ğŸ“– è¯¦ç»†æŸ¥è¯¢] 
    B -->|general| E[â„¹ï¸ ä¸€èˆ¬æŸ¥è¯¢]
    
    %% æŸ¥è¯¢é‡å†™é€»è¾‘ - åˆå¹¶ç›¸åŒå¤„ç†
    C --> KEEP[ğŸ“ ä¿æŒåŸæŸ¥è¯¢]
    D --> KEEP
    E --> REWRITE[ğŸ”„ æŸ¥è¯¢é‡å†™]
    
    %% æ‰€æœ‰æŸ¥è¯¢éƒ½è¿›å…¥ç»Ÿä¸€çš„æ£€ç´¢æµç¨‹
    KEEP --> F[ğŸ” æ··åˆæ£€ç´¢<br/>top_k=config.top_k]
    REWRITE --> F
    
    %% æ£€ç´¢é˜¶æ®µ
    F --> G[ğŸ“Š å‘é‡æ£€ç´¢<br/>config.embedding_model]
    F --> H[ğŸ”¤ BM25æ£€ç´¢<br/>å…³é”®è¯åŒ¹é…]
    
    %% RRFé‡æ’
    G --> I[âš¡ RRFé‡æ’èåˆ]
    H --> I
    I --> J[ğŸ“– æ£€ç´¢åˆ°å­å—]
    
    %% çˆ¶å­æ–‡æ¡£å¤„ç†
    J --> K[ğŸ§  æ™ºèƒ½å»é‡<br/>æŒ‰ç›¸å…³æ€§æ’åº]
    K --> L[ğŸ“š è·å–çˆ¶æ–‡æ¡£]
    
    %% ç”Ÿæˆé˜¶æ®µ - æ ¹æ®è·¯ç”±ç±»å‹é€‰æ‹©ä¸åŒæ¨¡å¼
    L --> M{ğŸ¨ ç”Ÿæˆæ¨¡å¼è·¯ç”±}
    M -->|listæŸ¥è¯¢| N[ğŸ“‹ ç”Ÿæˆèœå“åˆ—è¡¨<br/>ç®€æ´è¾“å‡º]
    M -->|detailæŸ¥è¯¢| O[ğŸ“ åˆ†æ­¥æŒ‡å¯¼æ¨¡å¼<br/>config.llm_model<br/>è¯¦ç»†æ­¥éª¤]
    M -->|generalæŸ¥è¯¢| P[ğŸ’¬ åŸºç¡€å›ç­”æ¨¡å¼<br/>config.temperature<br/>ä¸€èˆ¬ä¿¡æ¯]
    
    %% è¾“å‡ºç»“æœ
    N --> Q[âœ¨ è¿”å›ç»“æœ]
    O --> Q
    P --> Q
    
    %% æ•°æ®å‡†å¤‡å­æµç¨‹
    subgraph DataPrep [ğŸ“š æ•°æ®å‡†å¤‡æ¨¡å—]
        R[ğŸ“ åŠ è½½Markdownæ–‡ä»¶<br/>config.data_path] --> S[ğŸ”§ å…ƒæ•°æ®å¢å¼º]
        S --> T[âœ‚ï¸ æŒ‰æ ‡é¢˜åˆ†å—]
        T --> U[ğŸ·ï¸ çˆ¶å­å…³ç³»å»ºç«‹]
        U --> CHUNKS[ğŸ“¦ è¾“å‡ºæ–‡æœ¬å—chunks]
    end
    
    %% ç´¢å¼•æ„å»ºå­æµç¨‹  
    subgraph IndexBuild [ğŸ” ç´¢å¼•æ„å»ºæ¨¡å—]
        CHUNKS --> V[ğŸ¤– BGEåµŒå…¥æ¨¡å‹<br/>config.embedding_model]
        V --> W[ğŸ“Š FAISSå‘é‡ç´¢å¼•]
        W --> X[ğŸ’¾ ç´¢å¼•æŒä¹…åŒ–<br/>config.index_save_path]
    end
    
    %% é…ç½®ç®¡ç†å­æµç¨‹
    subgraph ConfigMgmt [âš™ï¸ é…ç½®ç®¡ç†]
        CFG1[ğŸ›ï¸ é»˜è®¤é…ç½®<br/>DEFAULT_CONFIG]
        CFG2[ğŸ”§ è‡ªå®šä¹‰é…ç½®<br/>RAGConfig]
        CFG3[ğŸŒ ç¯å¢ƒå˜é‡<br/>HF_ENDPOINT]
    end
    
    %% è¿æ¥é…ç½®åˆ°å„æ¨¡å—
    ConfigMgmt --> DataPrep
    ConfigMgmt --> IndexBuild
    ConfigMgmt --> F
    ConfigMgmt --> O
    ConfigMgmt --> P
    
    %% æ ·å¼å®šä¹‰
    classDef startup fill:#e3f2fd,stroke:#0277bd,stroke-width:2px
    classDef config fill:#f1f8e9,stroke:#388e3c,stroke-width:2px
    classDef userInput fill:#e1f5fe,stroke:#01579b,stroke-width:2px
    classDef routing fill:#f3e5f5,stroke:#4a148c,stroke-width:2px
    classDef rewrite fill:#e8eaf6,stroke:#3f51b5,stroke-width:2px
    classDef retrieval fill:#e8f5e8,stroke:#1b5e20,stroke-width:2px
    classDef generation fill:#fff3e0,stroke:#e65100,stroke-width:2px
    classDef output fill:#fce4ec,stroke:#880e4f,stroke-width:2px
    classDef module fill:#f1f8e9,stroke:#33691e,stroke-width:2px
    classDef cache fill:#fff8e1,stroke:#f57c00,stroke-width:2px
    classDef dataflow fill:#e1f5fe,stroke:#0277bd,stroke-width:2px
    
    %% åº”ç”¨æ ·å¼
    class START,INIT startup
    class CONFIG,ConfigMgmt,CFG1,CFG2,CFG3 config
    class INDEX_CHECK,LOAD_INDEX,SAVE_INDEX cache
    class A userInput
    class B,C,D,E,M routing
    class KEEP,REWRITE rewrite
    class F,G,H,I,J,K,L retrieval
    class N,O,P generation
    class Q output
    class DataPrep,IndexBuild module
    class BUILD_NEW,READY,DataPrepForRetrieval startup
    class CHUNKS dataflow
```

### 3.4 é¡¹ç›®ç»“æ„

åŸºäºä¸Šé¢çš„æ¶æ„ï¼Œå¯ä»¥æ„å»ºå‡ºå¦‚ä¸‹é¡¹ç›®ç»“æ„ï¼š

```text
code/C8/
â”œâ”€â”€ config.py                   # é…ç½®ç®¡ç†
â”œâ”€â”€ main.py                     # ä¸»ç¨‹åºå…¥å£
â”œâ”€â”€ requirements.txt            # ä¾èµ–åˆ—è¡¨
â”œâ”€â”€ rag_modules/               # æ ¸å¿ƒæ¨¡å—
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ data_preparation.py    # æ•°æ®å‡†å¤‡æ¨¡å—
â”‚   â”œâ”€â”€ index_construction.py  # ç´¢å¼•æ„å»ºæ¨¡å—
â”‚   â”œâ”€â”€ retrieval_optimization.py # æ£€ç´¢ä¼˜åŒ–æ¨¡å—
â”‚   â””â”€â”€ generation_integration.py # ç”Ÿæˆé›†æˆæ¨¡å—
â””â”€â”€ vector_index/              # å‘é‡ç´¢å¼•ç¼“å­˜ï¼ˆè‡ªåŠ¨ç”Ÿæˆï¼‰
```

## å°ç»“

æœ¬èŠ‚ä»é¡¹ç›®èƒŒæ™¯å‡ºå‘ï¼Œå®Œæˆäº†RAGç³»ç»Ÿçš„ç¯å¢ƒé…ç½®å’Œæ•´ä½“æ¶æ„è®¾è®¡ã€‚ä»ä¸‹ä¸€èŠ‚å¼€å§‹ï¼Œæˆ‘ä»¬å°†æ·±å…¥å­¦ä¹ å„ä¸ªæ¨¡å—çš„å…·ä½“å®ç°ï¼Œçœ‹çœ‹å¦‚ä½•å°†è¿™äº›è®¾è®¡æ€è·¯è½¬åŒ–ä¸ºå¯è¿è¡Œçš„ä»£ç ã€‚
